<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Quantconnect Trending System - Zhehan Shi</title>
<meta name="description" content="Quantconnect is World’s Leading Algorithmic Trading Platform It provides a free algorithm backtesting tool and financial data so engineers can design algorithmic trading strategies.  The following is a simple Trending System. It is for demo purpose only.  The model uses Bollinger Bands(BB) and Relative Strength Index(RSI)  Version 1 uses 4-hour aggregates. It is a Mean reverting strategy where it assumes SPY will revert to its historical mean.  BB uses past 30 data points and 2 standard deviation for bands RSI uses past 14 data points  The model sells when RSI &gt; 70 AND Price &gt; BB Upper Band  The model buys when RSI &lt; 30 AND Price &lt; BB Lower Band  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 #original  class Algo101_Version_1(QCAlgorithm):      def Initialize(self):         self.SetStartDate(2020, 1, 1)  # Set Start Date         self.SetEndDate(2020,10,1) #Comment         self.SetCash(100000)  # Set Strategy Cash         symbol = &quot;SPY&quot;         self.ticker = self.AddEquity(symbol,Resolution.Hour).Symbol         self.rsi = self.RSI(symbol, 14, MovingAverageType.Simple,Resolution.Hour)         self.bb = self.BB(symbol,30, 2, MovingAverageType.Simple,Resolution.Hour)         self.RegisterIndicator(symbol, self.rsi, timedelta(hours = 4))         self.RegisterIndicator(symbol, self.bb, timedelta(hours = 4))                   self.SetWarmup(timedelta(30))      def OnData(self, data):         symbol = &quot;SPY&quot;         if data[self.ticker] is None: return         if (not self.rsi.IsReady) or (not self.bb.IsReady): return          value = data[self.ticker].Value                  buy_signal = self.rsi.Current.Value &lt; 30 and value &lt; self.bb.LowerBand.Current.Value         sell_signal = self.rsi.Current.Value &gt; 70 and value &gt; self.bb.UpperBand.Current.Value                  if buy_signal: self.SetHoldings(symbol,1)         if sell_signal: self.SetHoldings(symbol,-1)                  if self.Portfolio.Invested:             if self.Portfolio[symbol].IsLong and not buy_signal:                 self.Liquidate(symbol)                              if self.Portfolio[symbol].IsShort and not sell_signal:                 self.Liquidate(symbol)      The model 1 performs badly.  The idea is to change Mean Reversion Strategy to Momentum Strategy by switching sell and buy signal and modify the RSI period and BollingerBands’ period and standard deviation.  Version 2 uses 4-hour aggregates. It is a momentum strategy where it assumes the price will maintain its momentum for a while  BB uses past 20 data points and 1.5 standard deviation for bands RSI uses past 10 data points  The model buys when RSI &lt; 40 AND Price &lt; BB Upper Band  The model sells when RSI &gt; 60 AND Price &gt; BB Lower Band  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 #original  class Algo101_Version_2(QCAlgorithm):      def Initialize(self):         self.SetStartDate(2020, 1, 1)  # Set Start Date         self.SetEndDate(2020,10,1) #Comment         self.SetCash(100000)  # Set Strategy Cash         symbol = &quot;SPY&quot;         self.ticker = self.AddEquity(symbol,Resolution.Hour).Symbol         self.rsi = self.RSI(symbol, 10, MovingAverageType.Simple,Resolution.Hour)         self.bb = self.BB(symbol,20, 1.5, MovingAverageType.Simple,Resolution.Hour)         self.RegisterIndicator(symbol, self.rsi, timedelta(hours = 4))         self.RegisterIndicator(symbol, self.bb, timedelta(hours = 4))                   self.SetWarmup(timedelta(30))      def OnData(self, data):         symbol = &quot;SPY&quot;         if data[self.ticker] is None: return         if (not self.rsi.IsReady) or (not self.bb.IsReady): return          value = data[self.ticker].Value                  sell_signal = self.rsi.Current.Value &lt; 40 and value &lt; self.bb.LowerBand.Current.Value         buy_signal = self.rsi.Current.Value &gt; 60 and value &gt; self.bb.UpperBand.Current.Value                  if buy_signal: self.SetHoldings(symbol,1)         if sell_signal: self.SetHoldings(symbol,-1)                  if self.Portfolio.Invested:             if self.Portfolio[symbol].IsLong and not buy_signal:                 self.Liquidate(symbol)                              if self.Portfolio[symbol].IsShort and not sell_signal:                 self.Liquidate(symbol)      Model 2 has a better return after modification.">


  <meta name="author" content="Zhehan Shi">
  
  <meta property="article:author" content="Zhehan Shi">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Zhehan Shi">
<meta property="og:title" content="Quantconnect Trending System">
<meta property="og:url" content="/finance/quant_trending_system/">


  <meta property="og:description" content="Quantconnect is World’s Leading Algorithmic Trading Platform It provides a free algorithm backtesting tool and financial data so engineers can design algorithmic trading strategies.  The following is a simple Trending System. It is for demo purpose only.  The model uses Bollinger Bands(BB) and Relative Strength Index(RSI)  Version 1 uses 4-hour aggregates. It is a Mean reverting strategy where it assumes SPY will revert to its historical mean.  BB uses past 30 data points and 2 standard deviation for bands RSI uses past 14 data points  The model sells when RSI &gt; 70 AND Price &gt; BB Upper Band  The model buys when RSI &lt; 30 AND Price &lt; BB Lower Band  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 #original  class Algo101_Version_1(QCAlgorithm):      def Initialize(self):         self.SetStartDate(2020, 1, 1)  # Set Start Date         self.SetEndDate(2020,10,1) #Comment         self.SetCash(100000)  # Set Strategy Cash         symbol = &quot;SPY&quot;         self.ticker = self.AddEquity(symbol,Resolution.Hour).Symbol         self.rsi = self.RSI(symbol, 14, MovingAverageType.Simple,Resolution.Hour)         self.bb = self.BB(symbol,30, 2, MovingAverageType.Simple,Resolution.Hour)         self.RegisterIndicator(symbol, self.rsi, timedelta(hours = 4))         self.RegisterIndicator(symbol, self.bb, timedelta(hours = 4))                   self.SetWarmup(timedelta(30))      def OnData(self, data):         symbol = &quot;SPY&quot;         if data[self.ticker] is None: return         if (not self.rsi.IsReady) or (not self.bb.IsReady): return          value = data[self.ticker].Value                  buy_signal = self.rsi.Current.Value &lt; 30 and value &lt; self.bb.LowerBand.Current.Value         sell_signal = self.rsi.Current.Value &gt; 70 and value &gt; self.bb.UpperBand.Current.Value                  if buy_signal: self.SetHoldings(symbol,1)         if sell_signal: self.SetHoldings(symbol,-1)                  if self.Portfolio.Invested:             if self.Portfolio[symbol].IsLong and not buy_signal:                 self.Liquidate(symbol)                              if self.Portfolio[symbol].IsShort and not sell_signal:                 self.Liquidate(symbol)      The model 1 performs badly.  The idea is to change Mean Reversion Strategy to Momentum Strategy by switching sell and buy signal and modify the RSI period and BollingerBands’ period and standard deviation.  Version 2 uses 4-hour aggregates. It is a momentum strategy where it assumes the price will maintain its momentum for a while  BB uses past 20 data points and 1.5 standard deviation for bands RSI uses past 10 data points  The model buys when RSI &lt; 40 AND Price &lt; BB Upper Band  The model sells when RSI &gt; 60 AND Price &gt; BB Lower Band  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 #original  class Algo101_Version_2(QCAlgorithm):      def Initialize(self):         self.SetStartDate(2020, 1, 1)  # Set Start Date         self.SetEndDate(2020,10,1) #Comment         self.SetCash(100000)  # Set Strategy Cash         symbol = &quot;SPY&quot;         self.ticker = self.AddEquity(symbol,Resolution.Hour).Symbol         self.rsi = self.RSI(symbol, 10, MovingAverageType.Simple,Resolution.Hour)         self.bb = self.BB(symbol,20, 1.5, MovingAverageType.Simple,Resolution.Hour)         self.RegisterIndicator(symbol, self.rsi, timedelta(hours = 4))         self.RegisterIndicator(symbol, self.bb, timedelta(hours = 4))                   self.SetWarmup(timedelta(30))      def OnData(self, data):         symbol = &quot;SPY&quot;         if data[self.ticker] is None: return         if (not self.rsi.IsReady) or (not self.bb.IsReady): return          value = data[self.ticker].Value                  sell_signal = self.rsi.Current.Value &lt; 40 and value &lt; self.bb.LowerBand.Current.Value         buy_signal = self.rsi.Current.Value &gt; 60 and value &gt; self.bb.UpperBand.Current.Value                  if buy_signal: self.SetHoldings(symbol,1)         if sell_signal: self.SetHoldings(symbol,-1)                  if self.Portfolio.Invested:             if self.Portfolio[symbol].IsLong and not buy_signal:                 self.Liquidate(symbol)                              if self.Portfolio[symbol].IsShort and not sell_signal:                 self.Liquidate(symbol)      Model 2 has a better return after modification.">







  <meta property="article:published_time" content="2020-10-05T00:00:00-04:00">





  

  


<link rel="canonical" href="/finance/quant_trending_system/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Zhehan Shi",
      "url": "/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Zhehan Shi Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Zhehan Shi
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/">Home</a>
            </li><li class="masthead__menu-item">
              <a href="/projects/">Projects</a>
            </li><li class="masthead__menu-item">
              <a href="/posts/">Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Quantconnect Trending System">
    <meta itemprop="description" content="Quantconnect is World’s Leading Algorithmic Trading PlatformIt provides a free algorithm backtesting tool and financial data so engineers can design algorithmic trading strategies.The following is a simple Trending System.It is for demo purpose only.The model uses Bollinger Bands(BB) and Relative Strength Index(RSI)Version 1 uses 4-hour aggregates.It is a Mean reverting strategy where it assumes SPY will revert to its historical mean.BB uses past 30 data points and 2 standard deviation for bandsRSI uses past 14 data pointsThe model sells when RSI &gt; 70 AND Price &gt; BB Upper BandThe model buys when RSI &lt; 30 AND Price &lt; BB Lower Band1234567891011121314151617181920212223242526272829303132333435#original class Algo101_Version_1(QCAlgorithm):    def Initialize(self):        self.SetStartDate(2020, 1, 1)  # Set Start Date        self.SetEndDate(2020,10,1) #Comment        self.SetCash(100000)  # Set Strategy Cash        symbol = &quot;SPY&quot;        self.ticker = self.AddEquity(symbol,Resolution.Hour).Symbol        self.rsi = self.RSI(symbol, 14, MovingAverageType.Simple,Resolution.Hour)        self.bb = self.BB(symbol,30, 2, MovingAverageType.Simple,Resolution.Hour)        self.RegisterIndicator(symbol, self.rsi, timedelta(hours = 4))        self.RegisterIndicator(symbol, self.bb, timedelta(hours = 4))                 self.SetWarmup(timedelta(30))    def OnData(self, data):        symbol = &quot;SPY&quot;        if data[self.ticker] is None: return        if (not self.rsi.IsReady) or (not self.bb.IsReady): return        value = data[self.ticker].Value                buy_signal = self.rsi.Current.Value &lt; 30 and value &lt; self.bb.LowerBand.Current.Value        sell_signal = self.rsi.Current.Value &gt; 70 and value &gt; self.bb.UpperBand.Current.Value                if buy_signal: self.SetHoldings(symbol,1)        if sell_signal: self.SetHoldings(symbol,-1)                if self.Portfolio.Invested:            if self.Portfolio[symbol].IsLong and not buy_signal:                self.Liquidate(symbol)                            if self.Portfolio[symbol].IsShort and not sell_signal:                self.Liquidate(symbol)The model 1 performs badly.The idea is to change Mean Reversion Strategy to Momentum Strategy by switching sell and buy signal and modify the RSI period and BollingerBands’ period and standard deviation.Version 2 uses 4-hour aggregates.It is a momentum strategy where it assumes the price will maintain its momentum for a whileBB uses past 20 data points and 1.5 standard deviation for bandsRSI uses past 10 data pointsThe model buys when RSI &lt; 40 AND Price &lt; BB Upper BandThe model sells when RSI &gt; 60 AND Price &gt; BB Lower Band1234567891011121314151617181920212223242526272829303132333435#original class Algo101_Version_2(QCAlgorithm):    def Initialize(self):        self.SetStartDate(2020, 1, 1)  # Set Start Date        self.SetEndDate(2020,10,1) #Comment        self.SetCash(100000)  # Set Strategy Cash        symbol = &quot;SPY&quot;        self.ticker = self.AddEquity(symbol,Resolution.Hour).Symbol        self.rsi = self.RSI(symbol, 10, MovingAverageType.Simple,Resolution.Hour)        self.bb = self.BB(symbol,20, 1.5, MovingAverageType.Simple,Resolution.Hour)        self.RegisterIndicator(symbol, self.rsi, timedelta(hours = 4))        self.RegisterIndicator(symbol, self.bb, timedelta(hours = 4))                 self.SetWarmup(timedelta(30))    def OnData(self, data):        symbol = &quot;SPY&quot;        if data[self.ticker] is None: return        if (not self.rsi.IsReady) or (not self.bb.IsReady): return        value = data[self.ticker].Value                sell_signal = self.rsi.Current.Value &lt; 40 and value &lt; self.bb.LowerBand.Current.Value        buy_signal = self.rsi.Current.Value &gt; 60 and value &gt; self.bb.UpperBand.Current.Value                if buy_signal: self.SetHoldings(symbol,1)        if sell_signal: self.SetHoldings(symbol,-1)                if self.Portfolio.Invested:            if self.Portfolio[symbol].IsLong and not buy_signal:                self.Liquidate(symbol)                            if self.Portfolio[symbol].IsShort and not sell_signal:                self.Liquidate(symbol)Model 2 has a better return after modification.">
    <meta itemprop="datePublished" content="2020-10-05T00:00:00-04:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Quantconnect Trending System
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>Quantconnect is World’s Leading Algorithmic Trading Platform
It provides a free algorithm backtesting tool and financial data so engineers can design algorithmic trading strategies.</p>

<p>The following is a simple <strong>Trending</strong> System.
It is for demo purpose only.</p>

<p>The model uses <strong><a href="https://school.stockcharts.com/doku.php?id=technical_indicators:bollinger_bands">Bollinger Bands</a></strong>(BB) and <strong><a href="https://school.stockcharts.com/doku.php?id=technical_indicators:relative_strength_index_rsi">Relative Strength Index</a></strong>(RSI)</p>

<p>Version 1 uses 4-hour aggregates.
It is a Mean reverting strategy where it assumes SPY will revert to its historical mean.</p>

<p>BB uses past 30 data points and 2 standard deviation for bands
RSI uses past 14 data points</p>

<p>The model sells when RSI &gt; 70 AND Price &gt; BB Upper Band</p>

<p>The model buys when RSI &lt; 30 AND Price &lt; BB Lower Band</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="code"><pre><span class="c1">#original 
</span><span class="k">class</span> <span class="nc">Algo101_Version_1</span><span class="p">(</span><span class="n">QCAlgorithm</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">Initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">SetStartDate</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Set Start Date
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">SetEndDate</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#Comment
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">SetCash</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>  <span class="c1"># Set Strategy Cash
</span>        <span class="n">symbol</span> <span class="o">=</span> <span class="s">"SPY"</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">ticker</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">AddEquity</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span><span class="n">Resolution</span><span class="p">.</span><span class="n">Hour</span><span class="p">).</span><span class="n">Symbol</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">rsi</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">RSI</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="n">MovingAverageType</span><span class="p">.</span><span class="n">Simple</span><span class="p">,</span><span class="n">Resolution</span><span class="p">.</span><span class="n">Hour</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">bb</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">BB</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">MovingAverageType</span><span class="p">.</span><span class="n">Simple</span><span class="p">,</span><span class="n">Resolution</span><span class="p">.</span><span class="n">Hour</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">RegisterIndicator</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">rsi</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span> <span class="o">=</span> <span class="mi">4</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">RegisterIndicator</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">bb</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span> <span class="o">=</span> <span class="mi">4</span><span class="p">))</span> 
        
        <span class="bp">self</span><span class="p">.</span><span class="n">SetWarmup</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">OnData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">symbol</span> <span class="o">=</span> <span class="s">"SPY"</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">ticker</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">rsi</span><span class="p">.</span><span class="n">IsReady</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">bb</span><span class="p">.</span><span class="n">IsReady</span><span class="p">):</span> <span class="k">return</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">ticker</span><span class="p">].</span><span class="n">Value</span>
        
        <span class="n">buy_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">rsi</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Value</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">bb</span><span class="p">.</span><span class="n">LowerBand</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Value</span>
        <span class="n">sell_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">rsi</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Value</span> <span class="o">&gt;</span> <span class="mi">70</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">bb</span><span class="p">.</span><span class="n">UpperBand</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Value</span>
        
        <span class="k">if</span> <span class="n">buy_signal</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">SetHoldings</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sell_signal</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">SetHoldings</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">Portfolio</span><span class="p">.</span><span class="n">Invested</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">Portfolio</span><span class="p">[</span><span class="n">symbol</span><span class="p">].</span><span class="n">IsLong</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">buy_signal</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">Liquidate</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
                
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">Portfolio</span><span class="p">[</span><span class="n">symbol</span><span class="p">].</span><span class="n">IsShort</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">sell_signal</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">Liquidate</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p><img src="/assets/images/model1_backtest.png" alt="model1_backtest" />
<img src="/assets/images/model1_stats.png" alt="model1_stats" /></p>

<p>The model 1 performs badly.</p>

<p>The idea is to change Mean Reversion Strategy to Momentum Strategy by switching sell and buy signal and modify the RSI period and BollingerBands’ period and standard deviation.</p>

<p>Version 2 uses 4-hour aggregates.
It is a momentum strategy where it assumes the price will maintain its momentum for a while</p>

<p>BB uses past 20 data points and 1.5 standard deviation for bands
RSI uses past 10 data points</p>

<p>The model buys when RSI &lt; 40 AND Price &lt; BB Upper Band</p>

<p>The model sells when RSI &gt; 60 AND Price &gt; BB Lower Band</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="code"><pre><span class="c1">#original 
</span><span class="k">class</span> <span class="nc">Algo101_Version_2</span><span class="p">(</span><span class="n">QCAlgorithm</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">Initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">SetStartDate</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Set Start Date
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">SetEndDate</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#Comment
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">SetCash</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>  <span class="c1"># Set Strategy Cash
</span>        <span class="n">symbol</span> <span class="o">=</span> <span class="s">"SPY"</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">ticker</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">AddEquity</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span><span class="n">Resolution</span><span class="p">.</span><span class="n">Hour</span><span class="p">).</span><span class="n">Symbol</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">rsi</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">RSI</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">MovingAverageType</span><span class="p">.</span><span class="n">Simple</span><span class="p">,</span><span class="n">Resolution</span><span class="p">.</span><span class="n">Hour</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">bb</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">BB</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">MovingAverageType</span><span class="p">.</span><span class="n">Simple</span><span class="p">,</span><span class="n">Resolution</span><span class="p">.</span><span class="n">Hour</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">RegisterIndicator</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">rsi</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span> <span class="o">=</span> <span class="mi">4</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">RegisterIndicator</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">bb</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span> <span class="o">=</span> <span class="mi">4</span><span class="p">))</span> 
        
        <span class="bp">self</span><span class="p">.</span><span class="n">SetWarmup</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">OnData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">symbol</span> <span class="o">=</span> <span class="s">"SPY"</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">ticker</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">rsi</span><span class="p">.</span><span class="n">IsReady</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">bb</span><span class="p">.</span><span class="n">IsReady</span><span class="p">):</span> <span class="k">return</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">ticker</span><span class="p">].</span><span class="n">Value</span>
        
        <span class="n">sell_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">rsi</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Value</span> <span class="o">&lt;</span> <span class="mi">40</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">bb</span><span class="p">.</span><span class="n">LowerBand</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Value</span>
        <span class="n">buy_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">rsi</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Value</span> <span class="o">&gt;</span> <span class="mi">60</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">bb</span><span class="p">.</span><span class="n">UpperBand</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Value</span>
        
        <span class="k">if</span> <span class="n">buy_signal</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">SetHoldings</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sell_signal</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">SetHoldings</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">Portfolio</span><span class="p">.</span><span class="n">Invested</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">Portfolio</span><span class="p">[</span><span class="n">symbol</span><span class="p">].</span><span class="n">IsLong</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">buy_signal</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">Liquidate</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
                
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">Portfolio</span><span class="p">[</span><span class="n">symbol</span><span class="p">].</span><span class="n">IsShort</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">sell_signal</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">Liquidate</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p><img src="/assets/images/model2_backtest.png" alt="model2_backtest" />
<img src="/assets/images/model2_stats.png" alt="model2_stats" /></p>

<p>Model 2 has a better return after modification.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#quant" class="page__taxonomy-item" rel="tag">Quant</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#finance" class="page__taxonomy-item" rel="tag">Finance</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-10-05T00:00:00-04:00">October 5, 2020</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=Quantconnect+Trending+System%20%2Ffinance%2Fquant_trending_system%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=%2Ffinance%2Fquant_trending_system%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=%2Ffinance%2Fquant_trending_system%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/statistics/time_series_analysis_101/" class="pagination--pager" title="Time Series Analysis 101
">Previous</a>
    
    
      <a href="/computer%20science/web_scraping_101/" class="pagination--pager" title="Web Scraping 101
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/computer%20science/data%20science/transformer_tutorial/" rel="permalink">Transformer Architecture Tutorial
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Here is the list of good resources to understand transformer architecture.


  
    Distilled AI on Transformer
  
  
    Harvard Annotated Transformer
  
  ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/philosohpy/perserverance/" rel="permalink">Curiosity &amp; Perserverance
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">This is a good tweet.

Riding my first #ebike today and it feels like the future has arrived.&mdash; Ben Cichy (@bencichy) November 22, 2019


</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/philosophy/Santa_truth/" rel="permalink">Santa Truth
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Growing up in the East, I have never understood the fascination that westerners have about Santa Claus. But I do know that it is culturally inappropriate to ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/computer%20science/star_wars_api/" rel="permalink">Star Wars API
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Star Wars API Jupyter Notebook HTML

The following is the same content as above but reformatted:

Intro

Exploring the Star Wars API. This is an open and fre...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <!-- <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>
 -->
<div class="page__footer-copyright">&copy; <!-- 2024  -->Zhehan Shi<!-- . Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; --></div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
   MathJax.Hub.Config({
     extensions: ["tex2jax.js"],
     jax: ["input/TeX", "output/HTML-CSS"],
     tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"] ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
       processEscapes: true
     },
     "HTML-CSS": { availableFonts: ["TeX"] }
   });
</script>

  </body>
</html>
